# Pusher 推送测试平台使用指南

## 概述

Pusher 推送测试平台是一个完整的推送功能测试工具，支持立即推送、定时推送、循环推送以及推送成功通知功能。

## 功能特性

- ✅ **多标签页界面**：推送测试、任务管理、统计信息
- ✅ **完整的推送配置**：支持所有推送类型和方式
- ✅ **实时消息监听**：接收推送消息和成功通知
- ✅ **任务管理**：查看推送任务列表和状态
- ✅ **统计信息**：查看推送统计数据
- ✅ **智能表单**：根据选择动态显示相关配置项

## 快速开始

### 1. 访问测试页面

```
http://localhost:8888/pusher-test.html
```

### 2. 基础配置

1. **输入用户ID**：在"用户ID"字段中输入您的用户ID（如：`test-user-123`）
2. **点击连接**：点击"连接"按钮建立 Pusher 连接
3. **确认连接状态**：确认显示"已连接"状态

### 3. 测试推送功能

#### 快速测试
- 点击"快速测试推送"按钮进行基础推送测试
- 点击"测试成功通知"按钮测试推送成功通知功能

#### 自定义推送
1. 切换到"📤 推送测试"标签页
2. 填写推送配置信息
3. 点击"发送推送"按钮

## 详细功能说明

### 📤 推送测试

#### 基础配置
- **推送标题**：推送消息的标题（必填）
- **推送内容**：推送消息的内容（必填）
- **推送描述**：推送消息的描述（可选）
- **推送类型**：notification（通知）、message（消息）、announcement（公告）

#### 推送方式

##### 立即推送
- 选择"立即推送"后，消息会立即发送给目标用户

##### 定时推送
- 选择"定时推送"后，需要设置推送时间
- 推送时间必须大于当前时间

##### 循环推送
- 选择"循环推送"后，需要配置循环参数
- **间隔推送**：设置间隔时间和时间单位（分钟/小时/天）
- **每日推送**：设置每日推送时间（HH:mm格式）
- **执行次数**：设置最大执行次数（1-100）

#### 目标用户配置

##### 所有用户
- 推送给系统中所有活跃用户

##### 指定用户
- 输入目标用户ID，多个用户用逗号分隔
- 例如：`user1,user2,user3`

##### 指定角色
- 输入目标角色，多个角色用逗号分隔
- 例如：`admin,user,moderator`

#### 成功通知配置

- **启用推送成功通知**：勾选后会在推送成功时发送通知
- **成功通知标题**：成功通知的标题（启用时必填）
- **成功通知内容**：成功通知的内容（启用时必填）

### 📋 任务管理

#### 功能说明
- 查看所有推送任务的列表
- 显示任务状态、推送方式、目标类型等信息
- 支持刷新任务列表

#### 任务状态说明
- **active**：活跃状态
- **inactive**：非活跃状态
- **draft**：草稿状态
- **sending**：发送中
- **sent**：已发送
- **failed**：发送失败

### 📊 统计信息

#### 显示内容
- **总任务数**：系统中所有推送任务的总数
- **活跃任务**：当前活跃状态的任务数
- **已发送**：已成功发送的任务数
- **失败任务**：发送失败的任务数
- **成功率**：推送成功率百分比
- **总发送数**：所有任务的总发送次数

## 消息日志

### 消息类型
- **系统消息**：蓝色背景，显示系统相关信息
- **成功消息**：绿色背景，显示成功操作信息
- **错误消息**：红色背景，显示错误信息
- **警告消息**：橙色背景，显示警告信息

### 日志内容
- 连接状态变化
- 推送操作结果
- 接收到的推送消息
- 接收到的成功通知
- 任务管理操作结果

## 使用示例

### 示例1：立即推送测试
1. 选择"立即推送"
2. 填写标题和内容
3. 选择"所有用户"
4. 点击"发送推送"

### 示例2：定时推送测试
1. 选择"定时推送"
2. 设置推送时间为当前时间后5分钟
3. 填写推送内容
4. 启用成功通知
5. 点击"发送推送"

### 示例3：循环推送测试
1. 选择"循环推送"
2. 选择"间隔推送"
3. 设置间隔为5分钟
4. 设置执行次数为3次
5. 点击"发送推送"

### 示例4：指定用户推送
1. 选择"指定用户"
2. 输入目标用户ID：`user1,user2`
3. 填写推送内容
4. 点击"发送推送"

## 故障排除

### 连接问题
- 确认用户ID已输入
- 检查网络连接
- 查看浏览器控制台错误信息

### 推送失败
- 检查必填字段是否完整
- 确认推送时间设置正确
- 查看服务器日志

### 收不到通知
- 确认已订阅正确的频道
- 检查事件监听是否正确
- 验证推送配置是否正确

## 技术说明

### 频道订阅
- **系统通知频道**：`system-notifications`（接收所有推送消息）
- **用户私有频道**：`private-user-{userId}`（接收个人成功通知）

### 事件监听
- **推送消息**：`notification` 事件
- **成功通知**：`success_notification` 事件

### API 接口
- **创建推送**：`POST /api/pusher/push`
- **获取任务列表**：`GET /api/pusher/tasks`
- **获取统计信息**：`GET /api/pusher/stats`

## 注意事项

1. **用户认证**：某些API可能需要用户认证，请确保已登录
2. **时间设置**：定时推送时间必须大于当前时间
3. **循环限制**：循环推送的执行次数限制在1-100之间
4. **目标用户**：指定用户推送时需要确保用户ID存在
5. **成功通知**：启用成功通知时必须提供标题和内容

## 更新日志

### v2.0.0
- 新增多标签页界面
- 新增完整的推送配置选项
- 新增任务管理功能
- 新增统计信息功能
- 优化用户界面和交互体验 